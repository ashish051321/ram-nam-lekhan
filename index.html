<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>‡§∞‡§æ‡§Æ ‡§®‡§æ‡§Æ ‡§≤‡•á‡§ñ‡§®</title>

  <link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./css/styles.css?v=20251101">
</head>
<body>
  <!-- Consent Popup -->
  <div id="consentPopup">
    <h3>üç™ Privacy & Analytics</h3>
    <p>We use Google Analytics to understand how visitors interact with our site. This helps us improve the experience. Your data is handled according to our privacy policy.</p>
    <div class="consent-buttons">
      <button class="consent-btn consent-accept" id="acceptAnalytics">Accept</button>
      <button class="consent-btn consent-decline" id="declineAnalytics">Decline</button>
    </div>
    <div class="consent-settings">
      <a href="#" id="privacyLink">Privacy Policy</a>
    </div>
  </div>

  <div id="counter">0 ‚úçÔ∏è</div>
  <div id="scoreBoard" aria-live="polite">
    <div class="score-item">
      <span class="score-label">Session Best</span>
      <span id="sessionBestScore" class="score-value">0</span>
    </div>
    <div class="score-item">
      <span class="score-label">All-Time Best</span>
      <span id="allTimeBestScore" class="score-value">0</span>
    </div>
    <div class="score-item">
      <span class="score-label">Session Avg</span>
      <span id="sessionAvgScore" class="score-value">0</span>
    </div>
  </div>
  <button id="toggleButton">Start Writing</button>
  <button id="backgroundSwitcher">üé®</button>
  <button id="soundToggle">üîä</button>
  <button id="whatsappShare"></button>
  <button id="mapButton" title="Live Map">üó∫Ô∏è</button>
  <button id="historyButton" title="History">üïò</button>
  <div id="hanuman"></div>

  <div class="wrap">
    <header>
      <div class="dot" aria-hidden="true"></div>
      <div>
        Tap / click anywhere or press <strong>Space</strong> to keep writing <strong>‚Äú‡§∞‡§æ‡§Æ‚Äù</strong>
      </div>
    </header>

    <main class="page" id="page" aria-label="Writing surface" role="application" tabindex="0">
      <span class="line" id="line"></span>
    </main>

    <!-- <div class="hint">Backspace to remove last word.</div> -->
  </div>

  <!-- Removed inline script: migrated to JS modules in js/ -->
  <script type="module" src="./js/index.js?v=20251107"></script>
  
  <!-- Map Modal -->
  <div id="mapModal" class="map-modal">
    <div class="map-dialog">
      <div class="map-header">
        <div class="map-title">Live Map</div>
        <div class="map-legend">
          <span class="map-swatch"></span>Active Writers
          <span class="map-swatch map-swatch-blue"></span>You<sub class="map-refresh-info">(Data is refreshed every 2 mins)</sub>
        </div>
        <div class="map-tools">
          <button id="mapZoomOut" class="map-zoom">‚àí</button>
          <button id="mapZoomIn" class="map-zoom">+</button>
          <button id="mapClose" class="map-close" aria-label="Close">‚úñ</button>
        </div>
      </div>
      <div class="map-content">
        <div class="map-user-list" id="mapUserList">
          <div class="map-list-header">Active Writers</div>
          <div class="map-list-items" id="mapListItems">
            <div class="map-list-loading">Loading users...</div>
          </div>
        </div>
        <div class="map-viewport" id="mapViewport">
          <div class="map-canvas" id="mapCanvas"></div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="page-loading-overlay" id="mapGlobalLoading" aria-live="polite" aria-busy="true" hidden>
    <div class="page-loading-spinner" role="presentation"></div>
    <div class="page-loading-text">Fetching live map‚Ä¶</div>
  </div>
  
  <!-- History Modal -->
  <div id="historyModal" class="history-modal">
    <div class="history-dialog">
      <div class="history-header">
        <div class="history-title">History</div>
        <div class="history-legend"><span class="legend-swatch"></span>108 completed</div>
        <button id="historyClose" class="history-close" aria-label="Close">‚úñ</button>
      </div>
      <div class="history-tabs" role="tablist">
        <button id="tabCalendar" class="history-tab active" role="tab" aria-selected="true">Calendar</button>
        <button id="tabSessions" class="history-tab" role="tab" aria-selected="false">Sessions</button>
      </div>
      <div id="tabPanelCalendar" class="tab-panel" role="tabpanel">
        <div class="history-cal">
          <div class="history-cal-header">
            <button id="calPrev" class="cal-nav" aria-label="Previous Month">‚óÄ</button>
            <div id="calMonthLabel" class="cal-month">Month YYYY</div>
            <button id="calNext" class="cal-nav" aria-label="Next Month">‚ñ∂</button>
          </div>
          <div class="history-cal-grid" id="historyCalendar"></div>
        </div>
      </div>
      <div id="tabPanelSessions" class="tab-panel" role="tabpanel" hidden>
        <div id="historyList" class="history-list"></div>
      </div>
      <div class="history-footer">
        <button id="historyClear" class="history-clear">Clear History</button>
      </div>
    </div>
  </div>
</body>
</html>
